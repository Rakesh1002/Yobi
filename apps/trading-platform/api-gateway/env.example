# ==============================================
# YOBI API GATEWAY ENVIRONMENT CONFIGURATION
# ==============================================
# Copy this file to .env and update with your actual values

# ==================== CORE API KEYS ====================
# Required for RAG functionality

# Pinecone Vector Database (REQUIRED for vector search)
PINECONE_API_KEY=your_pinecone_api_key_here

# OpenAI API (REQUIRED for embeddings)
OPENAI_API_KEY=your_openai_api_key_here

# Anthropic Claude API (REQUIRED for enhanced analysis)
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# ==================== DATABASE ====================
# Primary database connection
DATABASE_URL=your_postgresql_database_url_here

# ==================== AWS S3 STORAGE ====================
# Required for document uploads and file storage
AWS_ACCESS_KEY_ID=your_aws_access_key_here
AWS_SECRET_ACCESS_KEY=your_aws_secret_access_key_here
AWS_REGION=us-east-1
AWS_S3_BUCKET=your_s3_bucket_name_here

# ==================== WEB SEARCH ====================
# SearXNG - Self-hosted search engine (recommended)
SEARXNG_URL=http://localhost:8080
SEARXNG_SECRET_KEY=16b7JskJjrrQoMKXWyoMAoVV7MwXl4rItkCUkRL4aDM=

# External search APIs (optional fallbacks)
TAVILY_API_KEY=your_tavily_api_key_here
EXA_API_KEY=your_exa_api_key_here  
SERP_API_KEY=your_serp_api_key_here

# ==================== REDIS CACHE ====================
# For caching and background jobs
REDIS_URL=redis://localhost:6379
# OR for Upstash Redis
UPSTASH_REDIS_REST_URL=your_upstash_redis_url_here
UPSTASH_REDIS_REST_TOKEN=your_upstash_redis_token_here

# ==================== COMMUNICATION ====================
# Email service (SendGrid)
SENDGRID_API_KEY=your_sendgrid_api_key_here
SENDGRID_FROM_EMAIL=noreply@yourdomain.com

# SMS service (Twilio)
TWILIO_ACCOUNT_SID=your_twilio_account_sid_here
TWILIO_AUTH_TOKEN=your_twilio_auth_token_here
TWILIO_PHONE_NUMBER=your_twilio_phone_number_here

# ==================== PAYMENT ====================
# Stripe for payments
STRIPE_SECRET_KEY=your_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=your_stripe_publishable_key_here
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret_here

# ==================== MONITORING ====================
# Sentry for error tracking
SENTRY_DSN=your_sentry_dsn_here

# ==================== SECURITY ====================
# JWT secret for authentication
JWT_SECRET=your_very_secure_random_string_here
JWT_REFRESH_SECRET=your_very_secure_refresh_string_here

# ==================== SERVER CONFIG ====================
# Server configuration
PORT=3002
NODE_ENV=development

# ==================== RAG-SPECIFIC CONFIG ====================
# Pinecone index configuration (matches your setup)
PINECONE_INDEX_NAME=yobi
PINECONE_HOST=https://yobi-8je4tcg.svc.aped-4627-b74a.pinecone.io

# OpenAI model configuration
OPENAI_MODEL=text-embedding-3-small
OPENAI_MAX_TOKENS=8191

# Anthropic model configuration  
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
ANTHROPIC_MAX_TOKENS=4000

# Vector search configuration
VECTOR_SEARCH_TOP_K=10
VECTOR_SEARCH_THRESHOLD=0.7
EMBEDDING_DIMENSIONS=1024

# ==================== OPTIONAL FEATURES ====================
# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# File upload limits
MAX_FILE_SIZE_MB=100
ALLOWED_FILE_TYPES=pdf,docx,doc,txt,html

# Background processing
BACKGROUND_JOB_CONCURRENCY=3
BACKGROUND_JOB_RETRY_ATTEMPTS=3

# Cache configuration
CACHE_TTL_SECONDS=3600
ENABLE_CACHE=true

# Logging level
LOG_LEVEL=info

# ==================== SEARXNG CONFIGURATION ====================
# Search engine priorities (use 'searxng' as primary source)
SEARCH_ENGINE_PRIORITY=searxng,tavily,exa,serp
DEFAULT_SEARCH_SOURCE=searxng
SEARXNG_TIMEOUT=10000
SEARXNG_MAX_RESULTS=25

# ==================== DEVELOPMENT ====================
# Development-specific settings
ENABLE_CORS=true
ENABLE_MORGAN_LOGGING=true
ENABLE_REQUEST_ID=true

# ==================== STARTUP NOTES ====================
# Before starting the API Gateway, ensure SearXNG is running:
# cd apps/trading-platform/searxng && docker-compose up -d
# Verify at: http://localhost:8080 